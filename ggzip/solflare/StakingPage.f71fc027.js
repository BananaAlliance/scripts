"use strict";(self.webpackChunk_rise_wallet_solflare_extension=self.webpackChunk_rise_wallet_solflare_extension||[]).push([["StakingPage"],{"./src/pages/Staking/index.tsx":function(t,a,e){e.r(a),e.d(a,{default:function(){return ct}});var s=e("../../../node_modules/react/jsx-runtime.js"),n=e("../../../node_modules/react/index.js"),i=e("../../libs/foundation-ui/dist/index.js"),o=e("../../libs/solflare-shared/dist/assets/solana.png"),l=e("../../../node_modules/@fortawesome/pro-light-svg-icons/index.mjs"),r=e("../../libs/solflare-shared/dist/utils/lamportToSol.js"),c=e("../../libs/solflare-shared/dist/features/stakingCore/index.js"),d=e("../../libs/solflare-shared/dist/constants/mints.js"),u=e("../../libs/solflare-shared/dist/features/pfp/index.js"),k=e("../../libs/shared/dist/features/currencies/hooks/useTokenFiatValue.js"),m=e("../../libs/shared/dist/utils/displayPrice.js"),g=e("../../libs/solflare-shared/dist/utils/truncateMiddle.js"),p=({amount:t,walletName:a,walletPubkey:e})=>{const{value:n,suffix:o,prefix:r,price:c}=(0,k.Z)("SOL",t);return(0,s.jsx)(i.GGf,{avatar:(0,s.jsx)(i.Ce,{size:"xl",icon:l.owJ}),transactionFromItem:(0,s.jsx)(i.nrP,{title:(0,m.ED)({amount:t,displayType:"solana",suffix:" SOL"}),subtitle:c?(0,m.ED)({amount:n,displayType:"value",suffix:o,prefix:r}):void 0,avatar:(0,s.jsx)(i.qEK,{src:d.vx.logoURI})}),transactionToItem:(0,s.jsx)(i.nrP,{title:a,subtitle:(0,g.r)(e),avatar:(0,s.jsx)(u.yq,{publicKey:e})})})},x=e("../../../node_modules/react-router/esm/react-router.js"),j=e("../../libs/shared/dist/features/currencies/index.js"),h=e("../../libs/solflare-shared/dist/components/WebInfoTooltip/index.js"),v=e("../../../node_modules/react-i18next/dist/es/useTranslation.js"),w=e("../../libs/solflare-shared/dist/features/portfolio/hooks/useSolanaToken.js");const b=({wallet:t,withdrawStakeAccount:a,setWithdrawStakeAccount:e})=>{const{t:d}=(0,v.$)(),u=()=>{e(void 0)},{amount:k,withdrawStake:b,setCloseAccount:f,closeAccount:_,withdrawLoading:y}=((t,a,e)=>{const{replace:i}=(0,x.k6)(),{mutateAsync:o,isLoading:l}=(0,c.Uo)(),[d,u]=n.useState(!0),{data:k,isLoading:m}=(0,c.te)(),g=a.actions.find((t=>"withdraw"===t.name))?.metadata,j=(d?g?.amountWithClosing:g?.amount)||0,h=(0,r.s)(j);return{amount:h,validators:k,validatorsLoading:m,setCloseAccount:u,closeAccount:d,withdrawStake:()=>{o({amountLamports:j,wallet:t,confirmData:(0,s.jsx)(p,{amount:h.toString(),walletName:t.accountName,walletPubkey:t.getPublicKey()}),stakePubkey:a.publicKey,onBroadcast:()=>{e(),i("/staking")}})},withdrawLoading:l}})(t,a,u),{data:S}=(0,w.D)();return(0,s.jsxs)(i.eCl,{open:!0,onOpenChange:u,children:[(0,s.jsx)(i.V1P,{left:(0,s.jsx)(i.KsU,{icon:l.acZ,onClick:u,size:"l"}),center:d("withdraw")}),(0,s.jsx)(i.JHu,{children:(0,s.jsx)(i.T14,{children:(0,s.jsxs)(i.zsR,{children:[(0,s.jsx)(i.WiK,{label:(0,s.jsx)(i.__J,{children:d("table_token")}),children:(0,s.jsx)(i.Rty,{statuses:[],validatorImage:o,background:"dropDown",title:d("solana"),amount:(0,m.ED)({amount:k,displayType:"solana",suffix:" SOL"}),height:"s",value:(0,s.jsx)(j.sp,{value:k.multipliedBy(S?.solPrice?.price??0).toNumber()}),spacingX:"select",avatarSize:"s"})}),(0,s.jsx)(i.WiK,{label:(0,s.jsxs)(i.__J,{children:[d("table_validator"),(0,s.jsx)(h.s,{tooltip:d("staking_validator_description")})]}),children:(0,s.jsx)(i.IpT,{background:"dropDown",image:a.validator?.image??void 0,apr:(0,m.ED)({amount:a.validator?.apy??0,displayType:"medium",suffix:"% APY"}),title:a.validator?.name??(0,g.r)(a.validator?.votePublicKey)})}),(0,s.jsxs)(i.$BJ,{id:"cb-close",checked:_,onCheckedChange:t=>f(Boolean(t)),children:[(0,s.jsx)(i.keQ,{htmlFor:"cb-close",children:d("action_close_account")}),(0,s.jsx)(i.bEE,{tooltip:d("staking_withdraw_available_tooltip")})]})]})})}),(0,s.jsx)(i.p4T,{children:(0,s.jsx)(i.hE2,{children:(0,s.jsx)(i.zxk,{disabled:y,onClick:()=>{u(),b()},children:d("withdraw")})})})]})};var f=e("../../libs/solflare-shared/dist/features/stakingModal/extension/StakingModal.js"),_=e("../../../node_modules/bignumber.js/bignumber.js"),y=e.n(_),S=e("../../libs/solflare-shared/dist/features/stakingModal/utils/splitStakeErrors.js"),A=({amount:t,validatorName:a,validatorImage:e})=>{const{value:n,suffix:o,prefix:r,price:c}=(0,k.Z)("SOL",t),{t:u}=(0,v.$)(),g=(0,s.jsx)(i.nrP,{title:(0,m.ED)({amount:t,displayType:"solana",suffix:" SOL"}),subtitle:c?(0,m.ED)({amount:n,displayType:"value",suffix:o,prefix:r}):void 0,avatar:(0,s.jsx)(i.qEK,{src:d.vx.logoURI})}),p=a?(0,s.jsx)(i.nrP,{title:a,subtitle:u("staking_slrs_create_new_title"),avatar:(0,s.jsx)(i.qEK,{src:e})}):null;return(0,s.jsx)(i.GGf,{avatar:(0,s.jsx)(i.Ce,{size:"xl",icon:l.Mw$}),transactionFromItem:p||g,transactionToItem:p?g:void 0,hideFlowIcon:!0})},K=e("../../libs/solflare-shared/dist/features/stakingCore/constants.js");const C=({wallet:t,splitStakeAccount:a,setSplitStakeAccount:e})=>{const{t:d}=(0,v.$)(),u=()=>{e(void 0)},{maxAmountBN:k,setSelectedAmount:p,selectedAmount:j,error:w,splitStake:b}=((t,a,e)=>{const{replace:i}=(0,x.k6)(),[o,l]=(0,n.useState)(),{mutateAsync:d,isLoading:u}=(0,c.QC)(),{t:k}=(0,v.$)(),{data:m,isLoading:p}=(0,c.te)(),j=(0,r.s)(a.actions.find((t=>"split"===t.name))?.metadata?.amountMax||0),h=(0,r.s)(a.actions.find((t=>"split"===t.name))?.metadata?.amountMin||0),w=o?new(y())(o):void 0,b=(0,S.M)(w,h,j,k);return{splitStake:()=>d({amountSOL:o,wallet:t,confirmData:(0,s.jsx)(A,{validatorName:a.validator?.name??(0,g.r)(a.validator?.votePublicKey),validatorImage:a.validator?.image,amount:w?.toString()??"0"}),stakePubkey:a.publicKey,onBroadcast:()=>{e(),i("/staking")}}),splitStakeLoading:u,selectedAmount:o,setSelectedAmount:l,minAmountBN:h,maxAmountBN:j,validatorsLoading:p,validators:m,error:b}})(t,a,u);return(0,s.jsxs)(i.eCl,{open:!0,onOpenChange:u,children:[(0,s.jsx)(i.V1P,{left:(0,s.jsx)(i.KsU,{icon:l.acZ,onClick:u,size:"l"}),center:d("action_split")}),(0,s.jsx)(i.JHu,{children:(0,s.jsx)(i.T14,{children:(0,s.jsxs)(i.zsR,{children:[(0,s.jsx)(i.HEc,{label:(0,s.jsx)(i.__J,{htmlFor:"token-input",children:d("table_token")}),right:k.isGreaterThanOrEqualTo(K.T)&&(0,s.jsxs)(i.WOI,{onClick:()=>p(k.toString()),children:[d("swap_max"),": ",k.toString()," SOL"]}),id:"token-input",selectedToken:{tokenId:"-",symbol:"SOL",amount:"-",logoURI:o,verified:!0},amount:j||"",onAmountChange:t=>p(t.target.value),tokens:[],onSelectedTokenChange:()=>{},disabledTokenSelect:!0,amountTextInputType:"number"}),(0,s.jsx)(i.WiK,{label:(0,s.jsxs)(i.__J,{children:[d("table_validator"),(0,s.jsx)(h.s,{tooltip:d("staking_validator_description")})]}),children:(0,s.jsx)(i.IpT,{background:"dropDown",image:a.validator?.image??void 0,title:a.validator?.name??(0,g.r)(a.validator?.votePublicKey),apr:(0,m.ED)({amount:a.validator?.apy??0,suffix:"% APY",displayType:"medium"})})})]})})}),(0,s.jsxs)(i.p4T,{children:[w&&(0,s.jsx)(i.bZj,{variant:"error",title:w.title,message:w.message}),(0,s.jsx)(i.hE2,{children:(0,s.jsx)(i.zxk,{disabled:Boolean(w)||!j,onClick:()=>{u(),b()},children:d("action_split")})})]})]})};var D=e("../../../node_modules/@fortawesome/pro-solid-svg-icons/index.mjs");const P=()=>{const{t:t}=(0,v.$)(),{data:a,isLoading:e,isError:n}=(0,c.ku)(),[o,d]=(0,c.Bf)(),{push:u}=(0,x.k6)();if(n)return(0,s.jsx)("div",{children:t("error_something_wrong")});const k=a?.header,p=(0,r.s)(k?.totalAmount||0),j=a&&void 0!==k?.totalAmount?p.multipliedBy(new(y())(k?.price.usdPrice||0)):void 0,h={active:t("staking_status_active"),activating:t("staking_status_activating"),deactivating:t("staking_status_unstaking"),inactive:t("staking_status_unstaked"),empty:t("staking_status_empty"),inactiveDeactivating:t("staking_status_unstaking"),activeInactive:t("staking_status_unstaked")};return(0,s.jsxs)(i.m04,{children:[(0,s.jsx)(i.V1P,{left:(0,s.jsx)(i.KsU,{onClick:()=>u("/"),icon:l.acZ,size:"l"}),center:t("staking_title")}),(0,s.jsxs)(i.JHu,{children:[(0,s.jsx)(i.wrK,{isLoading:e,avatar:(0,s.jsx)(i.Ce,{size:"l",icon:D.Quw}),amount:(0,m.ED)({amount:p,displayType:"amount",suffix:" SOL"}),value:(0,m.ED)({amount:j,displayType:"value",prefix:"$"}),actions:[(0,s.jsx)(i.hE2,{justifyContent:"center",children:(0,s.jsx)(i.zxk,{disabled:e,onClick:d,children:t("action_stake")})},"actions-button")]}),(0,s.jsx)(i.ED3,{isLoading:e,onStakingAccountClick:t=>{u(`/staking/stake/${t.publicKey}`)},data:(a?.stakeAccounts||[]).map((t=>{const a=t.validator,e=a?a.name||(0,g.r)(a.votePublicKey):"Staking account",s=Boolean(t.lockup);return{publicKey:t.publicKey,title:e,locked:s,statuses:t.statuses.map((t=>{return{status:(a=t,{active:"active",inactive:"inactive",activating:"activating",deactivating:"deactivating",empty:"empty",inactiveDeactivating:"deactivating",activeInactive:"inactive"}[a]),text:h[t]??t};var a})),validatorImage:a?.image??void 0,amount:(0,m.ED)({amount:(0,r.s)(t.amount),displayType:"amount",suffix:" SOL"}),value:(0,m.ED)({amount:(0,r.s)(t.amount).multipliedBy(new(y())(k?.price.usdPrice||0)),displayType:"value",prefix:"$"})}}))})]})]})};var M=e("../../libs/shared/dist/utils/humanDate.js");const L=({stakingAccount:{publicKey:t,activationEpoch:a}})=>{const{t:e}=(0,v.$)(),{data:n,isFetching:o}=(0,c.tb)(t,a),l=n?.rewards??[],{data:d}=(0,w.D)(),u=!o&&l&&0===l?.length;return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(i.eKu,{isLoading:o,isEmpty:u,data:l??[],extractKey:t=>String(t.epoch),emptyStateMessage:e("staking_no_staking_rewards_yet"),renderItem:t=>(0,s.jsx)(i.qr_,{title:(0,M.rN)(1e3*t.rewardTime,!0,!1,!0),amount:(0,r.s)(t.amount).toString(),value:(0,s.jsx)(j.sp,{value:(0,r.s)(t.amount).multipliedBy(d?.solPrice?.price??0).toString()})})})})};var T=e("../../../node_modules/react-redux/es/index.js"),I=e("../../libs/solflare-shared/dist/store/selectors/config.js"),E=e("../../libs/rise-ui/dist/index.js");const H=({wallet:t,stakingAccount:a,openSplitModal:e,closeDropdown:n})=>{const{replace:i}=(0,x.k6)(),{t:o}=(0,v.$)(),l=a.actions.find((t=>"split"===t.name))?.metadata,d=a.actions.find((t=>"withdraw"===t.name||"partialWithdraw"===t.name))?.metadata?.amount??0,u=(0,r.s)(d).toString(),{mutate:k}=(0,c.Uo)();return(0,s.jsxs)(s.Fragment,{children:[l&&(0,s.jsx)(E.bK,{onClick:()=>{n(),e(a)},children:o("action_split")}),d>0&&(0,s.jsx)(E.bK,{onClick:()=>{n(),k({wallet:t,amountLamports:d,confirmData:(0,s.jsx)(p,{amount:u,walletName:t.accountName,walletPubkey:t.getPublicKey()}),stakePubkey:a.publicKey,onBroadcast:()=>{i("/staking")}})},children:o("action_withdraw_inactive",{token:"SOL"})})]})};var F=e("../../libs/solflare-shared/dist/features/staking/web/ExplorerDropDownItem.js"),B=e("../../libs/solflare-shared/dist/features/stakingModal/hooks/useUnstakeForm.js");const $=({stakingAccount:t,wallet:a,openSplitModal:e,closeDropdown:n})=>{const{replace:i}=(0,x.k6)(),{t:o}=(0,v.$)(),l=t.actions.find((t=>"split"===t.name))?.metadata,d=l?.amount&&l.amount>2e9,u=t.actions.find((t=>"withdraw"===t.name||"partialWithdraw"===t.name))?.metadata?.amount??0,k=(0,r.s)(u).toString(),{mutate:m}=(0,c.Uo)(),{standardUnstake:g}=(0,B.K)({stakeAccount:t});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(E.bK,{onClick:()=>{n(),g()},children:o("action_unstake")}),u>0&&(0,s.jsx)(E.bK,{onClick:()=>{n(),m({wallet:a,amountLamports:u,confirmData:(0,s.jsx)(p,{amount:k,walletName:a.accountName,walletPubkey:a.getPublicKey()}),stakePubkey:t.publicKey,onBroadcast:()=>{i("/staking")}})},children:o("action_withdraw_inactive",{token:"SOL"})}),d&&(0,s.jsx)(E.bK,{onClick:()=>{n(),e(t)},children:o("action_split")})]})},z=({stakingAccount:t,wallet:a,closeDropdown:e,openSplitModal:n})=>{const{replace:i}=(0,x.k6)(),{t:o}=(0,v.$)(),l=t.actions.find((t=>"withdraw"===t.name||"partialWithdraw"===t.name))?.metadata?.amount??0,d=(0,r.s)(l).toString(),{mutate:u}=(0,c.Uo)(),k=t.actions.find((t=>"split"===t.name))?.metadata;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(E.bK,{onClick:()=>{e(),u({wallet:a,amountLamports:l,confirmData:(0,s.jsx)(p,{amount:d,walletName:a.accountName,walletPubkey:a.getPublicKey()}),stakePubkey:t.publicKey,onBroadcast:()=>{i("/staking")}})},children:o("action_withdraw_unstaked",{token:"SOL"})}),k&&(0,s.jsx)(E.bK,{onClick:()=>{e(),n(t)},children:o("action_split")})]})},N=({stakingAccount:t,closeDropdown:a})=>{const{push:e}=(0,x.k6)(),{t:n}=(0,v.$)(),i=t.actions.find((t=>"delegate"===t.name)),o=Boolean(t.lockup);return i&&!o?(0,s.jsx)(E.bK,{onClick:()=>{a(),e(`/staking/restake/${t.publicKey}`)},children:n("action_stake")}):null};var U=e("../../libs/solflare-shared/dist/components/ConfirmationHelpers/ConfirmationStaking.js");const W=({stakingAccount:t,wallet:a,closeDropdown:e})=>{const{replace:n}=(0,x.k6)(),{t:i}=(0,v.$)(),o=t.actions.find((t=>"delegate"===t.name)),l=(0,r.s)(t.amount).toString(),{data:d}=(0,c.te)(),{mutateAsync:u}=(0,c.jg)(),k=t.actions.find((t=>"withdraw"===t.name||"partialWithdraw"===t.name))?.metadata?.amount??0,m=(0,r.s)(k).toString(),{mutate:j}=(0,c.Uo)();return(0,s.jsxs)(s.Fragment,{children:[o&&(0,s.jsx)(E.bK,{onClick:()=>{e(),u({validatorPubkey:t.voter,stakePubkey:t.publicKey,wallet:a,confirmData:(0,s.jsx)(U.Z,{validatorName:t.validator?.name??(0,g.r)(t.validator?.votePublicKey),validatorImage:t.validator?.image??void 0,amount:l}),onBroadcast:()=>{n("/staking")}})},children:i("action_restake")}),k>0&&(0,s.jsx)(E.bK,{onClick:()=>{e(),j({wallet:a,amountLamports:k,confirmData:(0,s.jsx)(p,{amount:m,walletName:a.accountName,walletPubkey:a.getPublicKey()}),stakePubkey:t.publicKey,onBroadcast:()=>{n("/staking")}})},children:i("action_withdraw_inactive",{token:"SOL"})})]})},O=({stakingAccount:t,wallet:a,openSplitModal:e,setSelectedRestakeAccount:o})=>{const r=(0,c.fZ)(t.statuses),[d,u]=n.useState(null),k=Boolean(d),m=()=>{u(null)};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.KsU,{icon:l.Uwo,size:"l",onClick:t=>{u(t.currentTarget)}}),(0,s.jsxs)(E.vb,{anchorEl:d,open:k,onClose:m,children:["active"===r&&(0,s.jsx)(H,{wallet:a,stakingAccount:t,openSplitModal:e,closeDropdown:m}),"activating"===r&&(0,s.jsx)($,{wallet:a,stakingAccount:t,openSplitModal:e,closeDropdown:m}),"deactivating"===r&&(0,s.jsx)(W,{stakingAccount:t,wallet:a,closeDropdown:m}),"inactive-active"===r&&(0,s.jsx)(z,{wallet:a,stakingAccount:t,openSplitModal:e,closeDropdown:m}),"inactive"===r&&(0,s.jsx)(N,{wallet:a,stakingAccount:t,closeDropdown:m,setSelectedRestakeAccount:o}),(0,s.jsx)(F.x,{onClose:m,publicKey:t.publicKey})]})]})};var J=e("../../libs/shared/dist/utils/timeRemaining.js"),V=e("../../libs/solflare-shared/dist/store/actions/common.js"),Z=e("../../libs/solflare-shared/dist/features/staking/shared/InstantUnstakeSpeedupBanner.js");const Y=({stakingAccount:t,openDeactivateModal:a})=>{const{t:e}=(0,v.$)(),{isFetching:n}=(0,c.ku)(),{standardUnstake:o}=(0,B.K)({stakeAccount:t});return(0,s.jsx)(i.hE2,{children:(0,s.jsx)(i.zxk,{variant:"secondary",disabled:n,onClick:()=>{t.lockup?o():a(t)},children:e("action_unstake")})})};var R=e("../../libs/solflare-shared/dist/components/ConfirmationHelpers/ConfirmationCloseStake.js");const q=({stakingAccount:t,wallet:a})=>{const{replace:e}=(0,x.k6)(),{t:n}=(0,v.$)(),o=t.actions.find((t=>"withdraw"===t.name))?.metadata?.amountWithClosing,{isFetching:l}=(0,c.ku)(),{mutateAsync:r,isLoading:d}=(0,c.Uo)(),u=t.validator;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.bZj,{title:n("staking_alert_view_only_title"),message:n("staking_alert_view_only_message"),variant:"info"}),o&&(0,s.jsx)(i.hE2,{children:(0,s.jsx)(i.zxk,{variant:"secondary",disabled:d||l,onClick:()=>{r({closeAccount:!0,amountLamports:o,wallet:a,confirmData:(0,s.jsx)(R.Z,{stakeStatus:(0,s.jsx)(i.f$5,{status:"empty",children:n("staking_status_empty")}),validatorName:u?.name??"Stake Account",validatorImage:u?.image}),stakePubkey:t.publicKey,onBroadcast:()=>{e("/staking")}})},children:n("action_close_account")})})]})},G=({stakingAccount:t,openWithdrawModal:a,wallet:e})=>{const{replace:n,push:o}=(0,x.k6)(),{t:l}=(0,v.$)(),{isFetching:d}=(0,c.ku)(),{mutateAsync:u,isLoading:k}=(0,c.Uo)(),m=t.actions.find((t=>"withdraw"===t.name)),g=t.actions.find((t=>"withdraw"===t.name))?.metadata?.amountWithClosing,j=t.validator,h=Boolean(t.lockup),w=t.actions.find((t=>"delegate"===t.name));return(0,s.jsxs)(i.hE2,{children:[w&&h&&(0,s.jsx)(i.zxk,{onClick:()=>{o(`/staking/restake/${t.publicKey}`)},children:l("action_stake")}),m?(0,s.jsx)(s.Fragment,{children:!j&&g?(0,s.jsx)(i.zxk,{disabled:k||d,onClick:()=>{u({amountLamports:g,wallet:e,confirmData:(0,s.jsx)(p,{amount:(0,r.s)(t.amount).toString(),walletName:e.accountName,walletPubkey:e.getPublicKey()}),stakePubkey:t.publicKey,onBroadcast:()=>{n("/staking")}})},children:l("action_withdraw")}):(0,s.jsx)(i.zxk,{onClick:()=>a(t),children:l("action_withdraw")})}):null]})},Q=({stakingAccount:t,openDeactivateModal:a})=>{const{t:e}=(0,v.$)(),{isFetching:n}=(0,c.ku)(),{standardUnstake:o}=(0,B.K)({stakeAccount:t});return(0,s.jsx)(i.hE2,{children:(0,s.jsx)(i.zxk,{variant:"secondary",disabled:n,onClick:()=>{t.lockup?o():a(t)},children:e("action_unstake")})})},X=({stakingAccount:t,wallet:a})=>{const{replace:e}=(0,x.k6)(),{t:n}=(0,v.$)(),o=t.actions.find((t=>"withdraw"===t.name||"partialWithdraw"===t.name))?.metadata?.amount??0,l=(0,r.s)(o).toString(),{mutate:d,isLoading:u}=(0,c.Uo)(),{isFetching:k}=(0,c.ku)();return(0,s.jsx)(i.zxk,{disabled:u||k,onClick:()=>d({wallet:a,amountLamports:o,confirmData:(0,s.jsx)(p,{amount:l,walletName:a.accountName,walletPubkey:a.getPublicKey()}),stakePubkey:t.publicKey,onBroadcast:()=>{e("/staking")}}),children:n("action_withdraw")})},tt=({stakingAccount:t,wallet:a})=>{const{t:e}=(0,v.$)();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.bZj,{title:e("staking_alert_partially_unstaked_title"),message:"Due to high network unstaking volume, it will take about 2-3 days longer to unstake your full amount.",variant:"info"}),(0,s.jsx)(i.hE2,{children:(0,s.jsx)(X,{wallet:a,stakingAccount:t})})]})},at=({wallet:t,setSplitAccount:a,setWithdrawAccount:e,setSelectedRestakeAccount:o,setDeactivateAccount:d})=>{const u=(0,T.I0)(),{data:k}=(0,c.ku)(),{stakeId:p}=(0,x.UO)(),{goBack:j}=(0,x.k6)(),{t:h}=(0,v.$)(),{cluster:w}=(0,T.v9)(I.eN),b="mainnet"===w,[f,_]=(0,n.useState)(""),S=k?.stakeAccounts.find((t=>t.publicKey===p));if(!S)return null;const A=S.validator,K=(0,c.fZ)(S.statuses),{title:C,pageHeroAvatarVariant:P,pageHeroIcon:M}=((t,a)=>{const e=(0,c.fZ)(t.statuses);return"active"===e?{title:a("staking_status_active"),pageHeroAvatarVariant:"stakingStatusStaked",pageHeroIcon:D.Quw}:"activating"===e?{title:a("staking_status_activating"),pageHeroAvatarVariant:"stakingStatusInProcess",pageHeroIcon:D.B2l}:"deactivating"===e?{title:a("staking_status_unstaking"),pageHeroAvatarVariant:"stakingStatusInProcess",pageHeroIcon:D.B2l}:"deactivating-inactive"===e?{title:a("staking_status_unstaking"),pageHeroAvatarVariant:"stakingStatusUnstaked",pageHeroIcon:D.owJ}:"inactive-active"===e?{title:a("staking_status_active"),pageHeroAvatarVariant:"stakingStatusStaked",pageHeroIcon:D.owJ}:"inactive"===e?{title:a("staking_status_unstaked"),pageHeroAvatarVariant:"stakingStatusUnstaked",pageHeroIcon:D.owJ}:"empty"===e?{title:a("staking_status_empty_title"),pageHeroAvatarVariant:"stakingStatusEmpty",pageHeroIcon:D.dLy}:{title:a("staking_status_unstaked"),pageHeroAvatarVariant:"stakingStatusUnstaked",pageHeroIcon:D.owJ}})(S,h),E=(0,r.s)(S.amount||0),H=k&&void 0!==k.header?.totalAmount?E.multipliedBy(new(y())(k.header?.price.usdPrice||0)):void 0,F=(0,J.X)(k?.header.epochEndSeconds??0),B=Boolean(S.lockup);return(0,s.jsxs)(i.m04,{children:[(0,s.jsx)(i.V1P,{left:(0,s.jsx)(i.KsU,{onClick:j,icon:l.acZ,size:"l"}),center:C,right:(0,s.jsx)(O,{wallet:t,stakingAccount:S,openSplitModal:a,setSelectedRestakeAccount:o})}),(0,s.jsxs)(i.JHu,{children:[(0,s.jsx)(i.wrK,{avatar:(0,s.jsx)(i.Ce,{background:P,size:"l",icon:M}),amount:(0,m.ED)({amount:E,displayType:"solana",suffix:" SOL"}),value:(0,m.ED)({amount:H,displayType:"value",prefix:"$"}),actions:(()=>{const a=[];switch(B&&a.push((0,s.jsx)(i.bZj,{title:h("staking_alert_locked_title"),message:h("staking_alert_locked_message"),variant:"info"},"actions-alert")),K){case"active":a.push((0,s.jsx)(Y,{stakingAccount:S,openDeactivateModal:d},"actions-button"));break;case"deactivating-inactive":a.push((0,s.jsx)(tt,{wallet:t,stakingAccount:S},"actions-button"));break;case"inactive-active":a.push((0,s.jsx)(Q,{stakingAccount:S,openDeactivateModal:d},"actions-button"));break;case"inactive":a.push((0,s.jsx)(G,{wallet:t,openWithdrawModal:e,stakingAccount:S},"actions-button"));break;case"empty":a.push((0,s.jsx)(q,{wallet:t,stakingAccount:S},"actions-button"))}return a})(),banner:"deactivating"===K||"deactivating-inactive"===K?(0,s.jsx)(Z.v,{stakeAccount:S}):void 0}),(A||b||B)&&(0,s.jsx)(i.TZ0,{activeTab:""!==f?f:A||B?"details":"rewards",onChange:t=>_(t),tabs:[...A||B?[{value:"details",label:h("form_details"),content:(0,s.jsxs)(i.jSm,{children:[B&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.stH,{title:h("staking_unlock_time_label"),content:(0,J.X)(S.lockup?.expiresInSeconds??0)}),(0,s.jsx)(i.izJ,{fullWidthNegativeMargin:!0})]}),A&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.stH,{title:h("staking_native_validator"),content:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.qEK,{size:"s",src:A.image||void 0}),A.name??(0,g.r)(A.votePublicKey),(0,s.jsx)(i.KsU,{icon:l.gJF,size:"s",onClick:()=>u((0,V.Wi)({account:A?.votePublicKey}))})]})}),(0,s.jsx)(i.izJ,{fullWidthNegativeMargin:!0})]}),S.statuses.includes("deactivating")&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.stH,{title:h("staking_unstake_time_label"),content:F}),(0,s.jsx)(i.izJ,{fullWidthNegativeMargin:!0})]}),S.statuses.includes("activating")&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.stH,{title:h("staking_stake_detail_time_to_stake_label"),content:F}),(0,s.jsx)(i.izJ,{fullWidthNegativeMargin:!0})]}),A&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.stH,{title:h("table_apy"),content:(0,m.ED)({amount:A.apy,displayType:"medium",suffix:"%"})}),(0,s.jsx)(i.izJ,{fullWidthNegativeMargin:!0}),(0,s.jsx)(i.stH,{title:h("staking_stake_detail_total_stake_label"),content:(0,m.ED)({amount:(0,r.s)(A.stakeActive),displayType:"none",suffix:" SOL"})})]})]})}]:[],...b?[{value:"rewards",label:h("form_rewards"),content:(0,s.jsx)(L,{stakingAccount:S})}]:[]]})]})]})},et=()=>{const{t:t}=(0,v.$)();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.V1P,{center:t("action_restake")}),(0,s.jsx)(i.JHu,{children:(0,s.jsx)(i.$jN,{size:"l"})})]})};var st=e("../../libs/solflare-shared/dist/features/stakingModal/hooks/useCreateStakeForm.js"),nt=e("../../libs/solflare-shared/dist/features/stakingModal/components/StakeForm.js");const it=({wallet:t,restakeAccount:a})=>{const{maxSOLBalance:e,selectedAmount:n,setSelectedValidator:o,selectedValidator:r,error:c,createStake:d,createStakeLoading:u,setValidatorFilter:k,validatorOptions:m,validatorsLoading:g,validatorsFetching:p}=(0,st.g)(t,a),{t:j}=(0,v.$)(),{goBack:h}=(0,x.k6)();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.V1P,{left:(0,s.jsx)(i.KsU,{onClick:h,icon:l.acZ,size:"l"}),center:j("action_stake")}),(0,s.jsx)(i.JHu,{children:(0,s.jsx)(i.T14,{children:(0,s.jsx)(i.zsR,{children:(0,s.jsx)(nt.m,{maxSOLBalance:e,selectedAmount:n,validatorOptions:m,onValidatorQueryChange:k,validatorsLoading:g,validatorsFetching:p,onValidatorChange:o,selectedValidator:r})})})}),(0,s.jsxs)(i.p4T,{children:[c&&(0,s.jsx)(i.bZj,{variant:"error",title:c.title,message:c.message}),(0,s.jsx)(i.hE2,{children:(0,s.jsx)(i.zxk,{disabled:void 0===n||0==+n||Boolean(c)||!r||u,onClick:d,children:j("action_stake")})})]})]})},ot=({wallet:t})=>{const{data:a}=(0,c.ku)(),{stakeId:e}=(0,x.UO)(),n=a?.stakeAccounts.find((t=>t.publicKey===e));return n?(0,s.jsx)(i.m04,{children:n?(0,s.jsx)(it,{wallet:t,restakeAccount:n}):(0,s.jsx)(et,{})}):(0,s.jsx)(et,{})};var lt=e("../../libs/solflare-shared/dist/features/stakingModal/shared/UnstakeModal.js");const rt=({wallet:t})=>{const{path:a}=(0,x.$B)(),[e,i]=n.useState(void 0),[o,l]=n.useState(void 0),[r,c]=n.useState(void 0),[d,u]=(0,n.useState)();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(P,{}),(0,s.jsx)(x.AW,{path:`${a}/stake/:stakeId`,children:(0,s.jsx)(at,{wallet:t,setSplitAccount:l,setWithdrawAccount:i,setSelectedRestakeAccount:c,setDeactivateAccount:u})}),(0,s.jsx)(x.AW,{path:`${a}/restake/:stakeId`,children:(0,s.jsx)(ot,{wallet:t})}),r&&(0,s.jsx)(f.C,{stakeAccount:r,setSelectedRestakeAccount:c}),e&&(0,s.jsx)(b,{wallet:t,withdrawStakeAccount:e,setWithdrawStakeAccount:i}),o&&(0,s.jsx)(C,{wallet:t,splitStakeAccount:o,setSplitStakeAccount:l}),d&&(0,s.jsx)(lt.K,{stakeAccount:d,close:()=>u(void 0)})]})};var ct=(0,e("../../libs/solflare-shared/dist/components/withWallet/index.js").a)()((({wallet:t})=>(0,s.jsx)(rt,{wallet:t})))},"../../libs/shared/dist/utils/humanDate.js":function(t,a,e){e.d(a,{ZR:function(){return l},pz:function(){return o},rN:function(){return i}});var s=e("../../../node_modules/dayjs/dayjs.min.js"),n=e.n(s);const i=(t,a=!0,e=!0,s=!1)=>{if(!t)return"Pending";const i=n()(e?t/1e3:t),o=n()();return i.isToday()?a?"Today":i.format("HH:mm"):i.isYesterday()?a?"Yesterday":i.format("HH:mm"):i.year()===o.year()?i.format(s?"D MMMM":"D MMM"):i.format(s?"D MMMM YYYY":"D MMM YYYY")},o=t=>{if(!t)return"Pending";const a=n()(t),e=n()();return a.isToday()?"Today":a.isYesterday()?"Yesterday":a.year()===e.year()?a.format("MMMM DD"):a.format("MMMM DD, YYYY")},l=t=>{if(!t)return"Pending";const a=n()(t);return`${o(t)} at ${a.format("HH:mm")}`}}}]);