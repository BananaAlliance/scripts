"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getDepositTransaction = void 0;
const viem_1 = require("viem");
const depositTransaction_js_1 = require("../types/depositTransaction.js");
const getSourceHash_js_1 = require("./getSourceHash.js");
function getDepositTransaction({ event, sourceHash, logIndex, l1BlockHash, domain = depositTransaction_js_1.SourceHashDomain.UserDeposit, }) {
    sourceHash = sourceHash ?? (0, getSourceHash_js_1.getSourceHash)({ domain, logIndex, l1BlockHash });
    const opaqueData = event.args.opaqueData;
    let offset = 0;
    const mint = (0, viem_1.slice)(opaqueData, offset, offset + 32);
    offset += 32;
    const value = (0, viem_1.slice)(opaqueData, offset, offset + 32);
    offset += 32;
    const gas = (0, viem_1.slice)(opaqueData, offset, offset + 8);
    offset += 8;
    const isCreation = BigInt(opaqueData[offset]) === 1n;
    offset += 1;
    const to = isCreation === true ? '0x' : event.args.to;
    const data = offset > (0, viem_1.size)(opaqueData) - 1
        ? '0x'
        : (0, viem_1.slice)(opaqueData, offset, opaqueData.length);
    const isSystemTransaction = false;
    return {
        sourceHash,
        from: event.args.from,
        to,
        mint: mint,
        value,
        gas,
        isSystemTransaction,
        data,
    };
}
exports.getDepositTransaction = getDepositTransaction;
//# sourceMappingURL=getDepositTransaction.js.map